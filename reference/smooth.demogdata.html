<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create smooth demogdata functions — smooth.demogdata • demography</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Create smooth demogdata functions — smooth.demogdata"><meta name="description" content="Smooth demogdata data using one of four methods depending on the value of method"><meta property="og:description" content="Smooth demogdata data using one of four methods depending on the value of method"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">demography</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/robjhyndman/demography/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create smooth demogdata functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/robjhyndman/demography/blob/master/R/smooth.R" class="external-link"><code>R/smooth.R</code></a></small>
      <div class="d-none name"><code>smooth.demogdata.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Smooth demogdata data using one of four methods depending on the value of <code>method</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smooth.demogdata</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">type</span>, mortality <span class="op">=</span> <span class="st">"mspline"</span>, fertility <span class="op">=</span> <span class="st">"cspline"</span>, migration <span class="op">=</span></span>
<span>    <span class="st">"loess"</span><span class="op">)</span>,</span>
<span>  <span class="va">age.grid</span>,</span>
<span>  power <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">type</span>, mortality <span class="op">=</span> <span class="fl">0.4</span>, fertility <span class="op">=</span> <span class="fl">1</span>, migration <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">65</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  span <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  interpolate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  weight <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">type</span> <span class="op">!=</span> <span class="st">"migration"</span>,</span>
<span>  obs.var <span class="op">=</span> <span class="st">"empirical"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Demogdata object such as created using <code><a href="read.demogdata.html">read.demogdata</a></code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method of smoothing. Possibilities: <code>"mspline"</code> (monotonic regression splines),
<code>"cspline"</code> (concave regression splines),
<code>"spline"</code> (unconstrained regression splines),
<code>"loess"</code> (local quadratic using <code><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></code>).</p></dd>


<dt id="arg-age-grid">age.grid<a class="anchor" aria-label="anchor" href="#arg-age-grid"></a></dt>
<dd><p>Ages to use for smoothed curves. Default is single years over a slightly greater range than the unsmoothed data.</p></dd>


<dt id="arg-power">power<a class="anchor" aria-label="anchor" href="#arg-power"></a></dt>
<dd><p>Power transformation for age variable before smoothing. Default is 0.4 for mortality data and 1 (no transformation) for fertility or migration data.</p></dd>


<dt id="arg-b">b<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Lower age for monotonicity if <code>method=="mspline"</code>. Above this, the smooth curve
is assumed to be monotonically increasing.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Number of knots to use for penalized regression spline estimate. Ignored if <code>method=="loess"</code>.</p></dd>


<dt id="arg-span">span<a class="anchor" aria-label="anchor" href="#arg-span"></a></dt>
<dd><p>Span for loess smooth if <code>method=="loess"</code>.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Penalty for constrained regression spline if <code>method=="cspline"</code>.</p></dd>


<dt id="arg-interpolate">interpolate<a class="anchor" aria-label="anchor" href="#arg-interpolate"></a></dt>
<dd><p>If <code>interpolate==TRUE</code>, a linear interpolation is used instead of smoothing.</p></dd>


<dt id="arg-weight">weight<a class="anchor" aria-label="anchor" href="#arg-weight"></a></dt>
<dd><p>If TRUE, uses weighted smoothing.</p></dd>


<dt id="arg-obs-var">obs.var<a class="anchor" aria-label="anchor" href="#arg-obs-var"></a></dt>
<dd><p>Method for computing observational variance. Possible values: “empirical” or “theoretical”.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Demogdata object identical to <code>data</code> except all
rate matrices are replaced with smooth versions and pop matrices are replaced with disaggregated population estimates obtained
using monotonic spline interpolation applied to the cumulative population data.
Weight
matrices are also added to the object showing the inverse
variances of the estimated smooth curves.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The value of <code>method</code> determines the type of smoothing used.</p><dl><dt>method="mspline"</dt>
<dd><p>Weighted penalized regression splines with a monotonicity constraint. The curves are monotonically
      increasing for age greater than b. Smoothness controlled by <code>k</code>. Methodology based on Wood (1994). Code calls <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> for the basic
      computations.</p></dd>

    <dt>method="cspline"</dt>
<dd><p>Weighted regression B-splines with a concavity constraint. Smoothness controlled by <code>lambda</code>.
      Methodology based on He and Ng (1999). Code calls <code><a href="https://rdrr.io/pkg/cobs/man/cobs.html" class="external-link">cobs</a></code> for the basic computations.</p></dd>

    <dt>method="spline"</dt>
<dd><p>Unconstrained weighted penalized regression splines. Equivalent to "mspline" but with <code>b=Inf</code>.</p></dd>

    <dt>method="loess"</dt>
<dd><p>Weighted locally quadratic regression. Smoothness controlled by span. Code calls
      <code><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess</a></code> for the basic computations.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rob J Hyndman</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">france.sm</span> <span class="op">&lt;-</span> <span class="fu">smooth.demogdata</span><span class="op">(</span><span class="fu"><a href="extract.years.html">extract.years</a></span><span class="op">(</span><span class="va">fr.mort</span>, <span class="fl">1980</span><span class="op">:</span><span class="fl">1997</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">france.sm</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="smooth.demogdata-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fr.mort</span>, years <span class="op">=</span> <span class="fl">1980</span>, type <span class="op">=</span> <span class="st">"p"</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">france.sm</span>, years <span class="op">=</span> <span class="fl">1980</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="smooth.demogdata-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rob Hyndman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

